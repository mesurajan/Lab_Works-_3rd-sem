contains the code of N_M and C_A
